---
phase: 01-foundation
plan: 03
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - src/app/(dashboard)/layout.tsx
  - src/app/(dashboard)/page.tsx
  - src/components/ui/button.tsx
  - src/components/ui/card.tsx
  - src/components/ui/input.tsx
  - src/components/navigation/header.tsx
  - src/components/navigation/mobile-nav.tsx
  - src/hooks/useSession.ts
  - src/types/index.ts
  - tailwind.config.ts
autonomous: false

must_haves:
  truths:
    - "App zeigt unterschiedliche Navigation je nach Rolle"
    - "Touch-Targets sind mindestens 48px hoch (76dp empfohlen)"
    - "Layout ist responsive (mobile-first)"
    - "KEWA AG sieht Admin-Navigation"
    - "Imeri sieht vereinfachte Handwerker-Navigation"
  artifacts:
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Dashboard layout with role-based nav"
      min_lines: 40
    - path: "src/components/ui/button.tsx"
      provides: "Touch-optimized button component"
      exports: ["Button"]
    - path: "src/components/navigation/header.tsx"
      provides: "App header with logout"
      exports: ["Header"]
    - path: "src/hooks/useSession.ts"
      provides: "Client-side session hook"
      exports: ["useSession"]
  key_links:
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/hooks/useSession.ts"
      via: "imports useSession"
    - from: "src/components/navigation/header.tsx"
      to: "/api/auth/logout"
      via: "fetch POST on logout click"
    - from: "src/components/ui/button.tsx"
      to: "min-h-[48px]"
      via: "Tailwind class for touch target"
---

<objective>
Create mobile-first base layout with role-based navigation and touch-optimized UI components.

Purpose: Establish the UI foundation that both KEWA AG and Imeri will use daily on mobile devices.
Output: Responsive dashboard layout with header, navigation, and reusable UI components.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
@.planning/phases/01-foundation/01-02-SUMMARY.md

@src/lib/auth.ts
@src/app/api/auth/session/route.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TypeScript types and session hook</name>
  <files>src/types/index.ts, src/hooks/useSession.ts, tailwind.config.ts</files>
  <action>
    Create src/types/index.ts with shared types:
    ```typescript
    export type Role = 'kewa' | 'imeri'

    export interface User {
      id: string
      role: Role
      displayName: string
    }

    export interface Session {
      authenticated: boolean
      user?: User
    }

    export type UnitType = 'apartment' | 'common_area' | 'building'
    export type TaskStatus = 'open' | 'completed'
    export type Priority = 'low' | 'normal' | 'high' | 'urgent'
    export type ProjectStatus = 'active' | 'completed' | 'archived'
    ```

    Create src/hooks/useSession.ts:
    - Fetch /api/auth/session on mount
    - Return { session, loading, error, refetch }
    - Use SWR or simple useState + useEffect
    - Handle loading state gracefully

    Update tailwind.config.ts:
    - Add custom spacing for touch targets: '76dp': '19px' (76dp at 4x density)
    - Actually use min-h-12 (48px) as base touch target
    - Add color palette for status indicators (green/yellow/red)
  </action>
  <verify>TypeScript compiles, useSession hook fetches session correctly</verify>
  <done>Type definitions and session hook ready for use in components</done>
</task>

<task type="auto">
  <name>Task 2: Create touch-optimized UI components</name>
  <files>src/components/ui/button.tsx, src/components/ui/card.tsx, src/components/ui/input.tsx</files>
  <action>
    Create Button component (src/components/ui/button.tsx):
    - Variants: primary, secondary, danger, ghost
    - Sizes: sm (h-10), md (h-12), lg (h-14) — all >= 48px for touch
    - Full width option
    - Loading state with spinner
    - Disabled state
    - Use Tailwind with cn() helper for class merging
    - Touch-friendly: min-h-12 (48px), adequate padding

    Create Card component (src/components/ui/card.tsx):
    - Simple container with shadow and rounded corners
    - CardHeader, CardContent, CardFooter subcomponents
    - Responsive padding (p-4 mobile, p-6 desktop)

    Create Input component (src/components/ui/input.tsx):
    - Touch-friendly height: h-12 (48px)
    - Variants: default, error
    - Label support
    - Error message display
    - Full width by default
    - inputMode support for numeric keyboards

    Install clsx for className merging:
    - npm install clsx tailwind-merge
    - Create src/lib/utils.ts with cn() function
  </action>
  <verify>Components render correctly, all have min-height of 48px</verify>
  <done>Touch-optimized Button, Card, Input components ready</done>
</task>

<task type="auto">
  <name>Task 3: Create navigation components and dashboard layout</name>
  <files>src/components/navigation/header.tsx, src/components/navigation/mobile-nav.tsx, src/app/(dashboard)/layout.tsx, src/app/(dashboard)/page.tsx</files>
  <action>
    Create Header component (src/components/navigation/header.tsx):
    - App title/logo on left
    - User role indicator (KEWA AG or Imeri)
    - Logout button on right
    - Sticky top, z-index for layering
    - Height: h-16 for touch-friendly interaction

    Create MobileNav component (src/components/navigation/mobile-nav.tsx):
    - Bottom navigation bar (mobile pattern)
    - Role-based items:
      - KEWA AG: Übersicht, Gebäude, Aufgaben, Audio, Einstellungen
      - Imeri: Meine Aufgaben, Audio
    - Active state indicator
    - Icons (use Lucide React: npm install lucide-react)
    - Touch targets: min 48px per item

    Create dashboard layout (src/app/(dashboard)/layout.tsx):
    - Wrap children with Header and MobileNav
    - Use useSession hook to get role
    - Pass role to nav components for conditional rendering
    - Main content area with proper padding
    - Safe area handling for notched devices

    Create placeholder dashboard page (src/app/(dashboard)/page.tsx):
    - Show different content based on role
    - KEWA AG: "Willkommen bei KEWA" + placeholder cards
    - Imeri: "Meine Aufgaben" + placeholder list
    - Use Card components for structure
  </action>
  <verify>npm run dev shows dashboard with header, content, and bottom nav</verify>
  <done>Complete dashboard layout with role-based navigation</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Mobile-first dashboard layout with role-based navigation and touch-optimized components</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/login
    3. Log in with KEWA AG PIN
    4. Verify: Header shows "KEWA AG", bottom nav shows 5 items
    5. Check touch targets: buttons and nav items are at least 48px tall
    6. Resize to mobile (375px): verify layout adapts, no horizontal scroll
    7. Log out, log in as Imeri
    8. Verify: Header shows "Imeri", bottom nav shows only 2 items
    9. Test on actual mobile device if possible (or Chrome DevTools device mode)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe layout/UX issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds
- [ ] Dashboard layout renders with header and bottom nav
- [ ] Navigation shows different items for KEWA AG vs Imeri
- [ ] All interactive elements have min-height of 48px
- [ ] Layout is responsive and works on mobile viewport
- [ ] Logout button works and redirects to login
- [ ] Human verified mobile layout and touch targets
</verification>

<success_criteria>
- Mobile-first layout working on all screen sizes
- Role-based navigation renders correctly for both roles
- Touch targets meet 48px minimum (76dp guideline)
- UI components (Button, Card, Input) are reusable
- Visual verification passed for mobile usability
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
