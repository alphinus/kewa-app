---
phase: 13-partner-modul
plan: 02
type: execute
wave: 2
depends_on: ["13-01"]
files_modified:
  - src/app/dashboard/partner/page.tsx
  - src/components/partners/PartnerList.tsx
  - src/components/partners/PartnerCard.tsx
autonomous: true

must_haves:
  truths:
    - "Admin sees Partner page at /dashboard/partner"
    - "Partner list shows company name, contact, trade categories for each partner"
    - "Active/inactive status is visible on each partner card"
    - "Admin can filter partners by active/inactive status"
    - "Admin can filter partners by partner type (contractor/supplier)"
    - "Empty state shows when no partners exist"
  artifacts:
    - path: "src/app/dashboard/partner/page.tsx"
      provides: "Partner list dashboard page"
      min_lines: 80
    - path: "src/components/partners/PartnerList.tsx"
      provides: "Partner list component with filtering"
      min_lines: 50
    - path: "src/components/partners/PartnerCard.tsx"
      provides: "Individual partner display card"
      min_lines: 40
  key_links:
    - from: "src/app/dashboard/partner/page.tsx"
      to: "/api/partners"
      via: "fetch in useEffect"
      pattern: "fetch.*api/partners"
    - from: "src/components/partners/PartnerList.tsx"
      to: "PartnerCard"
      via: "map rendering"
      pattern: "partners\\.map"
---

<objective>
Build Partner list UI with filtering for admin to view all partners at a glance.

Purpose: Fulfill PART-01 requirement - "Admin kann Partner-Liste mit allen Handwerkern anzeigen." This page becomes the entry point for all partner management.

Output: Dashboard page at /dashboard/partner with list of partners, filtering by status and type.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/13-partner-modul/13-RESEARCH.md

# API routes from prior plan
@.planning/phases/13-partner-modul/13-01-SUMMARY.md

# Existing UI patterns to follow
@src/app/dashboard/kosten/ausgaben/page.tsx
@src/components/costs/ExpenseList.tsx
@src/components/tasks/TaskList.tsx

# Type definitions
@src/types/database.ts (Partner interface, lines 322-335)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PartnerCard component</name>
  <files>src/components/partners/PartnerCard.tsx</files>
  <action>
Create PartnerCard component following existing Card component patterns:

```typescript
'use client'

import { Card, CardContent } from '@/components/ui/card'
import { Button } from '@/components/ui/button'
import type { Partner, TradeCategory } from '@/types'

// German labels for trade categories
const TRADE_LABELS: Record<TradeCategory, string> = {
  general: 'Allgemein',
  plumbing: 'Sanitaer',
  electrical: 'Elektro',
  hvac: 'Heizung/Lueftung',
  painting: 'Malerarbeiten',
  flooring: 'Bodenbelaege',
  carpentry: 'Schreinerei',
  roofing: 'Dachdecker',
  masonry: 'Maurer',
  glazing: 'Glaser',
  landscaping: 'Gartenbau',
  cleaning: 'Reinigung',
  demolition: 'Abbruch',
  other: 'Sonstige',
}

interface PartnerCardProps {
  partner: Partner
  onEdit: (partner: Partner) => void
  onToggleActive: (partner: Partner) => void
}
```

**Display:**
- Company name as title (large, bold)
- Partner type badge ('Handwerker' for contractor, 'Lieferant' for supplier)
- Contact name (if exists)
- Email with mailto: link
- Phone with tel: link
- Trade categories as pill/tag badges (use TRADE_LABELS)
- Active/inactive status indicator (green dot for active, gray for inactive)

**Actions:**
- Edit button (calls onEdit prop)
- Toggle active/inactive button (calls onToggleActive prop)

**Styling:**
- Use Tailwind utilities matching existing card styles
- Inactive partners should have muted/grayed appearance
- Hover state on card
  </action>
  <verify>
```bash
# Check TypeScript compilation
npx tsc --noEmit src/components/partners/PartnerCard.tsx

# Verify component exports
grep -n "export" src/components/partners/PartnerCard.tsx
```
  </verify>
  <done>PartnerCard component displays partner info with edit and toggle actions.</done>
</task>

<task type="auto">
  <name>Task 2: Create PartnerList component with filtering</name>
  <files>src/components/partners/PartnerList.tsx</files>
  <action>
Create PartnerList component following ExpenseList.tsx pattern:

```typescript
'use client'

import { useState, useEffect } from 'react'
import { Card, CardContent } from '@/components/ui/card'
import { PartnerCard } from './PartnerCard'
import type { Partner, PartnerType } from '@/types'

interface PartnerListProps {
  onEdit: (partner: Partner) => void
}
```

**State:**
- partners: Partner[]
- loading: boolean
- error: string | null
- filters: { isActive: 'all' | 'true' | 'false', partnerType: 'all' | 'contractor' | 'supplier' }

**Data fetching:**
- useEffect to fetch from /api/partners on mount and filter change
- Build query string from filters (skip params set to 'all')
- Handle loading, error, and empty states

**Filter UI:**
- Dropdown/select for active status: "Alle", "Aktiv", "Inaktiv"
- Dropdown/select for partner type: "Alle", "Handwerker", "Lieferanten"
- Filters update state, trigger refetch

**Toggle active handler:**
- Call PATCH /api/partners/[id] with { is_active: !partner.is_active }
- Refetch list on success

**Empty state:**
- Show "Keine Partner vorhanden" message in Card when list is empty

**Render:**
- Map partners to PartnerCard components
- Pass onEdit and onToggleActive handlers
  </action>
  <verify>
```bash
# Check TypeScript compilation
npx tsc --noEmit src/components/partners/PartnerList.tsx

# Verify imports and exports
grep -n "import\|export" src/components/partners/PartnerList.tsx
```
  </verify>
  <done>PartnerList fetches partners, renders PartnerCards, supports filtering and toggle active.</done>
</task>

<task type="auto">
  <name>Task 3: Create Partner dashboard page</name>
  <files>src/app/dashboard/partner/page.tsx</files>
  <action>
Create dashboard page at /dashboard/partner following ausgaben/page.tsx pattern:

```typescript
'use client'

import { useState } from 'react'
import { Button } from '@/components/ui/button'
import { PartnerList } from '@/components/partners/PartnerList'
import type { Partner } from '@/types'
```

**Layout:**
- Header with title "Partner" and subtitle "Handwerker und Lieferanten verwalten"
- "Neuer Partner" button in header (triggers modal or navigation)
- PartnerList component below

**State:**
- showForm: boolean (for create/edit modal)
- editingPartner: Partner | null (null = create mode, partner = edit mode)

**Handlers:**
- handleCreate: Set showForm true, editingPartner null
- handleEdit: Set showForm true, editingPartner to the partner
- handleSave: Close form, trigger list refresh
- handleCancel: Close form

**Note:** PartnerForm modal will be added in Plan 13-03. For now, handleEdit/handleCreate can just console.log('TODO: open form for', partner) as placeholder until form is ready.

**Styling:**
- Match existing dashboard pages (kosten/ausgaben)
- Responsive layout
- pb-20 for bottom padding (mobile nav)
  </action>
  <verify>
```bash
# Check TypeScript compilation
npx tsc --noEmit src/app/dashboard/partner/page.tsx

# Verify page renders (start dev server)
# Visit http://localhost:3000/dashboard/partner
```
  </verify>
  <done>Partner page renders at /dashboard/partner with list and "Neuer Partner" button.</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Navigate to page:** Visit http://localhost:3000/dashboard/partner
2. **Verify list loads:** Should show any existing partners or empty state
3. **Test filters:** Change active status and partner type filters, verify list updates
4. **Test toggle:** Click toggle active button on a partner, verify status changes
5. **Check responsive:** Test on mobile viewport
6. **TypeScript:** `npx tsc --noEmit` passes
</verification>

<success_criteria>
- [ ] /dashboard/partner page renders without errors
- [ ] PartnerList shows partners from API
- [ ] PartnerCard displays company name, contact, email, phone, trade categories
- [ ] Active/inactive status visible on each card
- [ ] Filter by active/inactive works
- [ ] Filter by contractor/supplier works
- [ ] Toggle active button updates partner status
- [ ] Empty state shown when no partners
- [ ] "Neuer Partner" button exists (form integration in plan 13-03)
- [ ] TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/13-partner-modul/13-02-SUMMARY.md`
</output>
