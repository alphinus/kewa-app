---
phase: 17-admin-onboarding
plan: 06
type: execute
wave: 2
depends_on: ["17-04"]
files_modified:
  - README.md
  - .env.example
autonomous: true

must_haves:
  truths:
    - "README includes Supabase project setup instructions"
    - "README includes Vercel deployment configuration"
    - "README includes environment variables list with descriptions"
    - "README includes first-run checklist"
    - ".env.example lists all required variables with placeholder values"
  artifacts:
    - path: "README.md"
      provides: "Deployment documentation"
      contains: "Supabase"
      min_lines: 100
    - path: ".env.example"
      provides: "Environment variable template"
      contains: "NEXT_PUBLIC_SUPABASE_URL"
  key_links:
    - from: "README.md"
      to: "supabase/seed_demo_data.sql"
      via: "documentation reference"
      pattern: "seed_demo_data"
---

<objective>
Create deployment README with Supabase/Vercel setup instructions.

Purpose: Addresses SEED-04 requirement for deployment documentation.
Output: Comprehensive README with deployment guide and .env.example file.
</objective>

<execution_context>
@C:\Users\Mario Giacchino\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Mario Giacchino\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/17-admin-onboarding/17-CONTEXT.md
@.planning/phases/17-admin-onboarding/17-RESEARCH.md

# Reference seed script from 17-04
@supabase/seed_demo_data.sql
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create/update .env.example</name>
  <files>.env.example</files>
  <action>
    Create or update .env.example with all required environment variables:

    ```
    # Supabase Configuration
    # Get these from: Supabase Dashboard -> Settings -> API
    NEXT_PUBLIC_SUPABASE_URL=https://your-project-ref.supabase.co
    NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
    SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

    # Application Settings
    NEXT_PUBLIC_APP_URL=http://localhost:3000
    SESSION_SECRET=generate-with-openssl-rand-base64-32

    # Optional: Analytics (if configured)
    # NEXT_PUBLIC_POSTHOG_KEY=your-posthog-key
    # NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com
    ```

    Include comment for each variable explaining:
    - What it's used for
    - Where to get the value
    - Whether it's required or optional

    IMPORTANT: Never include actual secret values. Use placeholder text only.
  </action>
  <verify>
    - .env.example exists
    - Contains NEXT_PUBLIC_SUPABASE_URL
    - Contains NEXT_PUBLIC_SUPABASE_ANON_KEY
    - Contains SUPABASE_SERVICE_ROLE_KEY
    - All values are placeholders, not real secrets
  </verify>
  <done>.env.example created with all variables documented</done>
</task>

<task type="auto">
  <name>Task 2: Create deployment README sections</name>
  <files>README.md</files>
  <action>
    Update or create README.md with deployment guide. Structure:

    ```markdown
    # KEWA Renovation Operations System

    Property renovation management for KEWA AG.

    ## Table of Contents
    - [Quick Start](#quick-start)
    - [Deployment Guide](#deployment-guide)
    - [Environment Variables](#environment-variables)
    - [Development](#development)

    ## Quick Start

    For local development:
    ```bash
    npm install
    cp .env.example .env.local  # Then fill in values
    npm run dev
    ```

    ## Deployment Guide

    ### Prerequisites
    - Supabase account (https://supabase.com)
    - Vercel account (https://vercel.com)
    - Node.js 20+

    ### 1. Supabase Setup

    #### Create Project
    1. Log in to Supabase Dashboard
    2. Click "New Project"
    3. Set project name: `kewa-renovation`
    4. Set database password (save securely)
    5. Choose region closest to users
    6. Wait for provisioning (~2 min)

    #### Run Migrations
    ```bash
    npm install -g supabase
    supabase link --project-ref <your-project-ref>
    supabase db push
    ```

    #### Seed Demo Data (Optional)
    ```bash
    supabase db execute -f supabase/seed_demo_data.sql
    ```

    ### 2. Vercel Deployment

    #### Connect Repository
    1. Log in to Vercel
    2. Import Git repository
    3. Configure environment variables (see below)
    4. Deploy

    ### 3. Environment Variables

    | Variable | Required | Description |
    |----------|----------|-------------|
    | NEXT_PUBLIC_SUPABASE_URL | Yes | Supabase project URL |
    | NEXT_PUBLIC_SUPABASE_ANON_KEY | Yes | Supabase public key |
    | SUPABASE_SERVICE_ROLE_KEY | Yes | Supabase service key (SECRET) |
    | SESSION_SECRET | Yes | Random 32-char string |
    | NEXT_PUBLIC_APP_URL | Yes | Your deployed URL |

    ### 4. First-Run Checklist

    After deployment:
    - [ ] Verify login page loads
    - [ ] Test PIN login
    - [ ] Complete setup wizard
    - [ ] Create test project
    - [ ] Check admin dashboard counts

    ## Development

    ```bash
    npm run dev      # Start development server
    npm run build    # Production build
    npm run lint     # Lint code
    ```
    ```

    Preserve any existing README content (features, architecture docs).
  </action>
  <verify>
    - README.md exists and is updated
    - Contains Supabase setup section
    - Contains Vercel deployment section
    - Contains environment variables table
    - Contains first-run checklist
    - References seed_demo_data.sql
  </verify>
  <done>README includes comprehensive deployment documentation</done>
</task>

<task type="auto">
  <name>Task 3: Add troubleshooting and support sections</name>
  <files>README.md</files>
  <action>
    Add troubleshooting section to README:

    ```markdown
    ## Troubleshooting

    ### "Invalid JWT" errors
    - Verify SUPABASE_SERVICE_ROLE_KEY is correct
    - Check if API keys were rotated in Supabase

    ### Storage uploads fail
    - Verify buckets exist: task-photos, task-audio
    - Check RLS policies applied (migration 015)

    ### Build fails
    - Verify Node.js version is 20+
    - Check all env variables are set
    - Review build logs for missing deps

    ### Login not working
    - Verify NEXT_PUBLIC_SUPABASE_URL is correct
    - Check network tab for API errors
    - Verify user exists in Supabase Auth

    ## Supabase-Vercel Integration

    For automatic env var sync:
    1. In Vercel Dashboard -> Integrations
    2. Search "Supabase"
    3. Connect your project
    4. Select env vars to sync

    ## Support

    - Supabase Docs: https://supabase.com/docs
    - Vercel Docs: https://vercel.com/docs
    - Next.js Docs: https://nextjs.org/docs
    ```
  </action>
  <verify>
    - README has troubleshooting section
    - Common issues documented with solutions
    - Supabase-Vercel integration mentioned
    - Support links included
  </verify>
  <done>README includes troubleshooting and support information</done>
</task>

</tasks>

<verification>
- [ ] .env.example lists all required variables
- [ ] .env.example has placeholder values only (no secrets)
- [ ] README has Supabase setup instructions
- [ ] README has Vercel deployment instructions
- [ ] README has environment variables table
- [ ] README has first-run checklist
- [ ] README references seed script
- [ ] README has troubleshooting section
</verification>

<success_criteria>
SEED-04 satisfied: README includes deployment instructions for Supabase, Vercel, and environment setup
</success_criteria>

<output>
After completion, create `.planning/phases/17-admin-onboarding/17-06-SUMMARY.md`
</output>
