---
phase: 17-admin-onboarding
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - supabase/seed_demo_data.sql
autonomous: true

must_haves:
  truths:
    - "Demo data script creates Swiss-realistic test data"
    - "Script is idempotent (safe to run multiple times)"
    - "Script creates 5+ properties, 15+ buildings, 20+ partners, 10+ projects"
    - "Data includes mix of active/completed/overdue projects"
    - "Demo records are tagged for easy identification"
  artifacts:
    - path: "supabase/seed_demo_data.sql"
      provides: "Idempotent demo data seed script"
      min_lines: 100
      contains: "IF NOT EXISTS"
  key_links:
    - from: "supabase/seed_demo_data.sql"
      to: "database tables"
      via: "INSERT statements"
      pattern: "INSERT INTO (properties|buildings|partners|projects|templates)"
---

<objective>
Create idempotent demo data seed script with Swiss-realistic test data.

Purpose: Addresses SEED-02 requirement for demo data script.
Output: SQL script that creates comprehensive test data for development/testing.
</objective>

<execution_context>
@C:\Users\Mario Giacchino\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Mario Giacchino\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/17-admin-onboarding/17-CONTEXT.md
@.planning/phases/17-admin-onboarding/17-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create comprehensive seed script</name>
  <files>supabase/seed_demo_data.sql</files>
  <action>
    Create supabase/seed_demo_data.sql with idempotent demo data:

    Structure using DO $$ block with IF NOT EXISTS check:
    ```sql
    DO $$
    BEGIN
      IF EXISTS (SELECT 1 FROM properties WHERE id = '00000000-0000-0000-0000-000000000001') THEN
        RAISE NOTICE 'Demo data already exists, skipping';
        RETURN;
      END IF;
      -- Insert all demo data here
    END $$;
    ```

    Data to create (Swiss-realistic):

    **Properties (5+):**
    - Liegenschaft Limmatstrasse (Zürich, 8005)
    - Liegenschaft Bundesplatz (Bern, 3011)
    - Wohnanlage Seefeld (Zürich, 8008)
    - Mehrfamilienhaus Oerlikon (Zürich, 8050)
    - Siedlung Wabern (Bern, 3084)

    **Buildings (15+):**
    - 2-3 buildings per property
    - Varying floor counts (3-6)
    - Realistic unit counts

    **Partners (20+):**
    Mix of contractors and suppliers with Swiss names:
    - Müller Sanitär AG (Sanitär, Heizung)
    - Brunner Elektro GmbH (Elektro)
    - Fischer Malerei (Malerei)
    - Weber Bodenbeläge AG (Bodenbeläge)
    - Schmid Schreiner GmbH (Schreiner)
    - Keller Gipser AG (Gipser)
    - Plus 15+ more with realistic trades
    - Include 2-3 inactive partners for testing filters

    **Projects (10+):**
    - 3-4 active projects (current work)
    - 2-3 completed projects (historical)
    - 2 overdue projects (deadline < now, not completed)
    - 2 stalled projects (updated_at < 7 days ago, not completed)

    **Templates (5+):**
    - Vollrenovation 3.5 Zimmer
    - Bad-Sanierung
    - Küchen-Einbau
    - Malerarbeiten
    - Bodenbelag-Erneuerung

    Use fixed UUIDs for referential integrity:
    - Properties: 00000000-0000-0000-0000-00000000000X
    - Buildings: 00000000-0000-0000-0000-0000000000XX
    - Partners: 00000000-0000-0000-0000-000000000XXX
    - Projects: 00000000-0000-0000-0000-00000000XXXX

    All dates relative to NOW() for freshness.
  </action>
  <verify>
    - File exists at supabase/seed_demo_data.sql
    - Contains DO $$ block with existence check
    - Contains 5+ property inserts
    - Contains 15+ building inserts
    - Contains 20+ partner inserts
    - Contains 10+ project inserts
    - Uses Swiss place names and company names
  </verify>
  <done>Comprehensive seed script created with Swiss-realistic data</done>
</task>

<task type="auto">
  <name>Task 2: Add varied project statuses</name>
  <files>supabase/seed_demo_data.sql</files>
  <action>
    Ensure project data includes variety needed for dashboard alerts:

    1. Overdue projects (for red alert badge):
       - deadline in the past (NOW() - INTERVAL '5 days')
       - status = 'active' (not completed)
       - At least 2 overdue projects

    2. Stalled projects (for yellow alert badge):
       - updated_at more than 7 days ago (NOW() - INTERVAL '10 days')
       - status = 'active'
       - At least 2 stalled projects

    3. Completed projects (for history):
       - status = 'completed'
       - deadline in past, updated_at near deadline
       - At least 3 completed projects

    4. Active healthy projects:
       - status = 'active'
       - deadline in future
       - updated_at recent
       - At least 3 active projects

    Add project phases/tasks for some projects to test Digital Twin history.
  </action>
  <verify>
    - Script has projects with deadline < NOW() (overdue)
    - Script has projects with updated_at < NOW() - 7 days (stalled)
    - Script has completed projects
    - Script has healthy active projects
  </verify>
  <done>Project data covers all status scenarios for dashboard testing</done>
</task>

<task type="auto">
  <name>Task 3: Add cleanup notice and verify idempotency</name>
  <files>supabase/seed_demo_data.sql</files>
  <action>
    Add header comments and cleanup instructions:

    ```sql
    -- =====================================================
    -- KEWA Demo Data Seed Script
    -- =====================================================
    --
    -- Swiss-realistic demo data for development/testing
    -- IDEMPOTENT: Safe to run multiple times
    --
    -- To clean up demo data:
    -- DELETE FROM projects WHERE id LIKE '00000000-0000-0000-0000-00000000%';
    -- DELETE FROM templates WHERE id LIKE '00000000-0000-0000-0000-00000000%';
    -- DELETE FROM partners WHERE id LIKE '00000000-0000-0000-0000-0000000001%';
    -- DELETE FROM buildings WHERE id LIKE '00000000-0000-0000-0000-0000000000%';
    -- DELETE FROM properties WHERE id LIKE '00000000-0000-0000-0000-0000000000%';
    --
    -- To run: supabase db execute -f supabase/seed_demo_data.sql
    -- =====================================================
    ```

    At end of script, add RAISE NOTICE with summary:
    ```sql
    RAISE NOTICE 'Demo data created:';
    RAISE NOTICE '  Properties: 5';
    RAISE NOTICE '  Buildings: 15+';
    RAISE NOTICE '  Partners: 20+';
    RAISE NOTICE '  Projects: 10+';
    RAISE NOTICE '  Templates: 5';
    ```
  </action>
  <verify>
    - Script has header comments with description
    - Cleanup instructions included
    - RAISE NOTICE at end confirms data created
    - Running script twice does not duplicate data
  </verify>
  <done>Seed script is well-documented and verified idempotent</done>
</task>

</tasks>

<verification>
- [ ] supabase/seed_demo_data.sql exists
- [ ] Script uses IF NOT EXISTS pattern (idempotent)
- [ ] Contains 5+ Swiss properties with addresses
- [ ] Contains 15+ buildings across properties
- [ ] Contains 20+ partners (contractors and suppliers)
- [ ] Contains 10+ projects with varied statuses
- [ ] Includes overdue and stalled projects for alerts
- [ ] Fixed UUIDs used for referential integrity
- [ ] Cleanup instructions in header comments
</verification>

<success_criteria>
SEED-02 satisfied: Demo data script creates realistic test data for development/testing
</success_criteria>

<output>
After completion, create `.planning/phases/17-admin-onboarding/17-04-SUMMARY.md`
</output>
